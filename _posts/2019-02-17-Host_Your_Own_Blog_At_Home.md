---
layout: post
title: Host Your Own Blog At Home
description: A step by step guildline to setup your own blog at home.
tags: 
    - Jekyll
    - DDNS
    - NGINX
    - Let's Encrypt
    - Linux box
---

## Prerequisites

* Linux box, e.g. Ubuntu 18
* Domain name, e.g. [https://tao.ren][my blog]
* DDNS, i.e Dynamic DNS, is a dynamic IP address to be aliased to a static hostname, allowing a computer on the network to be more easily accessible from the Internet.



## Overview

If you have a Linux box at home, you can use it to host your [own blog][my blog], which could be generated by [Jekyll][jekyll offical].

* Setup your Linux box

* Network
  * Setup your router
  * [Setup your DDNS][ddns client]
  * Setup your domain name

* Blog
  * [Setup Jekyll envrionment][setup jekyll]
  * Build your blog.

* HTTP Server & Certificate
  * [Setup NGINX][install nginx]
  * [Setup Let's Encrypt][let's encrypt with nginx]

Enjoy your blog [http://tao.ren][my blog]

## Setup your Linux box

1. [Create a bootable USB stick](https://tutorials.ubuntu.com/tutorial/tutorial-create-a-usb-stick-on-ubuntu#0)
1. [Install Ubuntu Server](https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server#0)

## Setup your router

Your router should have port forwarding setting, most likely in Firewall section, make sure any incoming connections on port 80 & 443 are forwarded to your Linux box.


## Setup your DDNS

If your router also support DDNS, make sure it is bound to your domain name: [https://tao.ren][my blog].

Otherwise, try dynu, install [DDClient][ddns client] on your Linux box, you are all set.


## Setup your domain name

Your domain name provdier usually needs your custom nameservers. Put whatever your DDNS provider says. 

For dynu, you could do 
- NS1.dynu.com
- NS6.dynu.com

## Setup Jekyll developement envrionment

[Set Up a Jekyll Development Site][setup jekyll]
```shell
sudo apt-get update
sudo apt-get install ruby ruby-dev make build-essential
gem install bundler
```

## Build your blog

Clone you blog project, go into it.

```shell
bundle install

export LANGUAGE="en_US.UTF-8"
export LC_ALL="C.UTF-8"
export LANG="en_US.UTF-8"

bundel exec jekyll build

```
The static html blog website will be built in folder `your-blog-root-directory/_site/`



## Setup NGINX

[Install Nginx][install nginx].

```shell
sudo apt install nginx
```

Make a new server block at /etc/nginx/sites-available/tao.ren:
```shell
sudo nano /etc/nginx/sites-available/tao.ren
```

Enable the file by creating a link from it to the sites-enabled directory:

```shell
sudo ln -s /etc/nginx/sites-available/tao.ren /etc/nginx/sites-enabled/
```

Link the server blog to your blog, paste in the following configuration block, updated for our new directory and domain name:
```
server {
        listen 80;
        listen [::]:80;

        root your-blog-root-directory/_site;
        index index.html index.htm index.nginx-debian.html;

        server_name tao.ren;

        location / {
                try_files $uri $uri/ =404;
        }
}
```


## Setup Let's Encrypt

[Using Free Let‚Äôs Encrypt SSL/TLS Certificates with NGINX][let's encrypt with nginx]

Download and install the Let‚Äôs Encrypt Client
```shell
add-apt-repository ppa:certbot/certbot
sudo apt-get install python-certbot-nginx
```

Obtain the SSL/TLS Certificate
```shell
sudo certbot --nginx -d tao.ren
```

Automatic Renewal of Let‚Äôs Encrypt Certificates
```shell
crontab -e
```

Add the certbot command to run daily. In this example, we run the command every day at noon. The command checks to see if the certificate on the server will expire within the next 30 days, and renews it if so. The --quiet directive tells certbot not to generate output.
```
0 12 * * * /usr/bin/certbot renew --quiet
```


## Enjoy

Your own blog hosted at home, [http://tao.ren][my blog]

üçªüçªüçª



------



[let's encrypt with nginx]: https://www.nginx.com/blog/using-free-ssltls-certificates-from-lets-encrypt-with-nginx/
[my blog]: https://touren.me
[jekyll offical]: https://jekyllrb.com/
[install nginx]: https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-18-04-quickstart

[setup jekyll]: https://www.digitalocean.com/community/tutorials/how-to-set-up-a-jekyll-development-site-on-ubuntu-16-04

[ddns client]: https://www.dynu.com/DynamicDNS/IPUpdateClient/DDClient